<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Creates an hrc file (hierarchy) from several variables in a set of
microdata set.
Crée un fichier hrc (hiérarchie) à partir de plusieurs variables d'un jeu de
microdonnées."><title>Creates a hrc file from microdata — write_hrc • rtauargus</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Creates a hrc file from microdata — write_hrc"><meta property="og:description" content="Creates an hrc file (hierarchy) from several variables in a set of
microdata set.
Crée un fichier hrc (hiérarchie) à partir de plusieurs variables d'un jeu de
microdonnées."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">rtauargus</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/rtauargus.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/options_safety_rules.html">Safety rules and Suppress Options</a>
    <a class="dropdown-item" href="../articles/protect_multi_tables.html">Protect several linked tables at once</a>
    <a class="dropdown-item" href="../articles/rtauargus_micro.html">&amp;tau;-Argus from R</a>
    <a class="dropdown-item" href="../articles/rtauargus_micro_fr.html">&amp;tau;-Argus depuis R</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"></ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Creates a hrc file from microdata</h1>
      <small class="dont-index">Source: <a href="https://github.com/inseefrlab/rtauargus/blob/HEAD/R/hrc.R" class="external-link"><code>R/hrc.R</code></a></small>
      <div class="d-none name"><code>write_hrc.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Creates an hrc file (hierarchy) from several variables in a set of
microdata set.<br>
Crée un fichier hrc (hiérarchie) à partir de plusieurs variables d'un jeu de
microdonnées.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">write_hrc</span><span class="op">(</span></span>
<span>  <span class="va">microdata</span>,</span>
<span>  <span class="va">vars_hrc</span>,</span>
<span>  hierleadstring <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"rtauargus.hierleadstring"</span><span class="op">)</span>,</span>
<span>  hrc_filename <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  fill_na <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"up"</span>, <span class="st">"down"</span><span class="op">)</span>,</span>
<span>  compact <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  hierlevels <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>microdata</dt>
<dd><p>[<strong>required</strong>] data.frame containing the microdata. <br>
([<strong>obligatoire</strong>] data.frame contenant les microdonnées.)</p></dd>


<dt>vars_hrc</dt>
<dd><p><strong>[mandatory]</strong> vector of variable names
constituting the hierarchy, from the finest to the most aggregated level.<br>
(<strong>[obligatoire]</strong> vecteur des noms des variables
  constituant la hiérarchie, du niveau le plus fin au niveau le plus agrégé.)</p></dd>


<dt>hierleadstring</dt>
<dd><p>character which, repeated n times, indicates that the value is
at n levels deep in the hierarchy. <br>
(caractère qui, répété n fois, indique que la valeur est
à n niveaux de profondeur dans la hiérarchie.)</p></dd>


<dt>hrc_filename</dt>
<dd><p>name and location of the produced hrc file. If not
filled, a temporary file.<br>
(nom et emplacement du fichier hrc produit. Si non renseigné, un fichier temporaire.)</p></dd>


<dt>fill_na</dt>
<dd><p>fill in any missing values, using an other variable :</p><ul><li><p><code>"up"</code> (default) : hierarchical variable of the level level
immediately above</p></li>
<li><p><code>"down"</code> : hierarchical variable of the level immediately
lower</p></li>
</ul><p><br>
(remplissage d'éventuelles valeurs manquantes, à l'aide d'une
  autre variable :</p><ul><li><p><code>"up"</code> (défaut) : variable hiérarchique de niveau
       immédiatement supérieur</p></li>
<li><p><code>"down"</code> : variable hiérarchique de niveau immédiatement
       inférieur</p></li>
</ul><p>)</p></dd>


<dt>compact</dt>
<dd><p>to prune branches repeating a single value to the
lowest level of depth (<code>TRUE</code> by default).<br>
(pour élaguer les branches répétant une unique valeur jusqu'au
  plus bas niveau de profondeur (<code>TRUE</code> par défaut).)</p></dd>


<dt>hierlevels</dt>
<dd><p>if only one variable is specified in <code>vars_hrc</code>,
allows to generate the hierarchy according to the position of the characters in the
string. For example, <code>hierlevels = "2 3"</code> to build a
hierarchy from a common code.<br>
(si une seule variable est spécifiée dans <code>vars_hrc</code>,
  permet de générer la hiérarchie selon la position des caractères dans la
  chaîne. Par exemple, <code>hierlevels = "2 3"</code> pour construire une
  hiérarchie département-commune à partir d'un code commune.)</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>The name of the hrc file (useful in the case of a temporary file with
random name).<br></p>


<p>(Le nom du fichier hrc (utile dans le cas d'un fichier temporaire au
  nom aléatoire).)</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The function reconstructs the variable hierarchy from the levels
present in the data. The variables in <code>vars_hrc</code> must be
<strong>classified from the finest to the most aggregated</strong>.</p>
<p>The relationship between each hierarchical level must be an application (in the
mathematical sense of the term), i.e. each fine level must have a
single corresponding aggregated level. The creation of the hierarchy is
impossible if this condition is not met.</p>
<p>If the name of the output file is not specified, a temporary file is
created. It will be deleted at the end of the session. The path to this file can be
retrieved in the return value of the function.</p>
<p>Missing values in the hierarchical variables will be
imputed beforehand using another hierarchical variable (parameter
<code>fill_na</code>). In ascending strategy (<code>"up"</code>), the variables are
from the most aggregated to the most refined, and vice versa in the
downward strategy (<code>"down"</code>).</p>
<p>The parameter <code>compact</code> allows to create hierarchies with variable
depths. The idea is to cut the branches consisting of a single value
repeated up to the maximum depth (see examples).<br></p>
<p>La fonction reconstitue la hiérarchie des variables à partir des niveaux
présents dans les données. Les variables dans <code>vars_hrc</code> doivent être
<strong>classées de la plus fine à la plus agrégée</strong>.</p>
<p>La relation entre chaque niveau hiérarchique doit être une application (au
sens mathématique du terme), c'est-à-dire que chaque niveau fin doit avoir un
seul et unique niveau agrégé correspondant. La création de la hiérarchie est
impossible si cette condition n'est pas remplie.</p>
<p>Si le nom du fichier en sortie n'est pas spécifié, un fichier temporaire est
créé. Il sera effacé en fin de session. Le chemin vers ce fichier peut être
récupéré dans la valeur de retour de la fonction.</p>
<p>Les valeurs manquantes présentes dans les variables hiérarchiques seront
préalablement imputées à l'aide d'une autre variable hiérarchique (paramètre
<code>fill_na</code>). En stratégie ascendante (<code>"up"</code>), les variables sont
parcourues de la plus agrégée à la plus fine, et inversement en stratégie
descendante (<code>"down"</code>).</p>
<p>Le paramètre <code>compact</code> permet de créer des hiérarchies à profondeurs
variables. L'idée est de couper les branches constituées d'une seule valeur
répétée jusqu'à la profondeur maximale (voir exemples).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Full Hierarchy ............................</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">df_naf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  A10 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"AZ"</span>, <span class="st">"BE"</span>, <span class="st">"BE"</span>, <span class="st">"BE"</span>, <span class="st">"BE"</span>, <span class="st">"BE"</span>, <span class="st">"BE"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  A21 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span> , <span class="st">"C"</span> , <span class="st">"B"</span> , <span class="st">"C"</span> , <span class="st">"C"</span> , <span class="st">"C"</span> , <span class="st">"B"</span> <span class="op">)</span>,</span></span>
<span class="r-in"><span>  A88 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"01"</span>, <span class="st">"10"</span>, <span class="st">"06"</span>, <span class="st">"10"</span>, <span class="st">"12"</span>, <span class="st">"11"</span>, <span class="st">"07"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">tmp_file</span> <span class="op">&lt;-</span> <span class="fu">write_hrc</span><span class="op">(</span><span class="va">df_naf</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A88"</span>, <span class="st">"A21"</span>, <span class="st">"A10"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/file.show.html" class="external-link">file.show</a></span><span class="op">(</span><span class="va">tmp_file</span>, pager <span class="op">=</span> <span class="st">"console"</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>error in running command</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">tmp_file</span> <span class="op">&lt;-</span> <span class="fu">write_hrc</span><span class="op">(</span><span class="va">df_naf</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A88"</span>, <span class="st">"A10"</span><span class="op">)</span>, hierleadstring <span class="op">=</span> <span class="st">":"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/file.show.html" class="external-link">file.show</a></span><span class="op">(</span><span class="va">tmp_file</span>, pager <span class="op">=</span> <span class="st">"console"</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>error in running command</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Hierarchy with varying depth  ...............</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  niv1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>  , <span class="st">"A"</span>  , <span class="st">"A"</span>  , <span class="st">"B"</span>  , <span class="st">"C"</span>  , <span class="st">"C"</span> <span class="op">)</span>,</span></span>
<span class="r-in"><span>  niv2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A1"</span> , <span class="st">"A1"</span> , <span class="st">"A2"</span> ,  <span class="cn">NA</span>  , <span class="st">"C1"</span> , <span class="st">"C2"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  niv3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A1x"</span>, <span class="st">"A1y"</span>,  <span class="cn">NA</span>  ,  <span class="cn">NA</span>  , <span class="st">"C1"</span> ,  <span class="cn">NA</span> <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">tmp_file</span> <span class="op">&lt;-</span> <span class="fu">write_hrc</span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"niv3"</span>, <span class="st">"niv2"</span>, <span class="st">"niv1"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>valeurs manquantes imputees pour construire la hierarchie</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/file.show.html" class="external-link">file.show</a></span><span class="op">(</span><span class="va">tmp_file</span>, pager <span class="op">=</span> <span class="st">"console"</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>error in running command</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">tmp_file</span> <span class="op">&lt;-</span> <span class="fu">write_hrc</span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"niv3"</span>, <span class="st">"niv2"</span>, <span class="st">"niv1"</span><span class="op">)</span>, compact <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>valeurs manquantes imputees pour construire la hierarchie</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/file.show.html" class="external-link">file.show</a></span><span class="op">(</span><span class="va">tmp_file</span>, pager <span class="op">=</span> <span class="st">"console"</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>error in running command</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Pierre-Yves Berrard, Julien Jamme, Nathanaël Rastout, Jeanne Pointet, Félix Beroud.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer></div>

  

  

  </body></html>

