<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Comment poser du secret sur des tableaux à 4 ou 5 dimensions avec `rtauargus`? • rtauargus</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Comment poser du secret sur des tableaux à 4 ou 5 dimensions avec `rtauargus`?">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">rtauargus</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.2.999</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/rtauargus.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>tabular-wise</h6></li>
    <li><a class="dropdown-item" href="../articles/rtauargus_fr.html">Tau-Argus depuis R - données tabulées</a></li>
    <li><a class="dropdown-item" href="../articles/protect_multi_tables.html">Protect several linked tables at once</a></li>
    <li><a class="dropdown-item" href="../articles/protect_multi_tables_fr.html">Protéger des tableaux liés</a></li>
    <li><a class="dropdown-item" href="../articles/options_safety_rules.html">Safety rules and Suppress Options</a></li>
    <li><a class="dropdown-item" href="../articles/options_safety_rules_fr.html">Les arguments Safety rules et Suppress</a></li>
    <li><a class="dropdown-item" href="../articles/split_tab_fr.html">Comment poser du secret sur des tableaux à 4 ou 5 dimensions avec `rtauargus`?</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>auto-analysis</h6></li>
    <li><a class="dropdown-item" href="../articles/auto_metadata.html">Automatic analysis of metadata</a></li>
    <li><a class="dropdown-item" href="../articles/auto_metadata_fr.html">Analyse automatique des métadonnées</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>micro-wise</h6></li>
    <li><a class="dropdown-item" href="../articles/rtauargus_micro.html">&amp;tau;-Argus from R - microdata version</a></li>
    <li><a class="dropdown-item" href="../articles/rtauargus_micro_fr.html">Tau-Argus depuis R - sur microdonnées</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Comment poser du secret sur des tableaux à 4 ou 5 dimensions avec `rtauargus`?</h1>
            <h3 data-toc-skip class="subtitle"><h2>
<br><img src="../reference/figures/rtauargus_logo_small.png" alt="logo rtauargus"><br>
</h2></h3>
            
      
      <small class="dont-index">Source: <a href="https://github.com/inseefrlab/rtauargus/blob/master/vignettes/split_tab_fr.Rmd" class="external-link"><code>vignettes/split_tab_fr.Rmd</code></a></small>
      <div class="d-none name"><code>split_tab_fr.Rmd</code></div>
    </div>

    
    
<!--
  NE JAMAIS MODIFIER DIRECTEMENT `rtauargus.Rmd`
  MODIFIER `rtauargus.Rmd.orig` ET EXECUTER `precompilation.R`
  Voir : https://ropensci.org/technotes/2019/12/08/precompute-vignettes
-->
<p>Les algorithmes de pose du secret secondaire tels qu’Optimal ou
Modular implémentés dans <code>Tau-Argus</code> reposent sur un
programme d’optimisation sous contraintes. Le nombre de ces constraintes
devient très difficile à gérer - du moins dans un temps raisonnable -
pour <code>Tau-Argus</code>. La pose du secret sur un tableau à 5
dimensions directement avec <code>Tau-Argus</code> est impossible et les
résultats fournis par le logiciel lors du traitement d’un tableau de 4
dimensions sont accompagnés d’un avertissement. Par ailleurs, un tableau
à 4 dimensions dont l’une est hiérarchique est un problème, en général,
très difficile pour <code>Tau-Argus</code>.</p>
<p>Le package <code>rtauargus</code> offre désormais la possibilité de
protéger des tableaux de 4 à 5 dimensions. Pour les tableaux de 4
dimensions, la protection est même plus rapide et permet de traiter des
tableaux plus grands encore (en nombre de lignes). Certains tableaux
demeurent néanmoins trop complexes pour <code>Tau-Argus</code>.</p>
<p>Cette nouvelle fonctionnalité est mise à disposition dans les
fonctions <code>tab_rtauargus</code> et <code>tab_multi_manager</code>
avec l’argument <code>split_tab</code>. Quand il est renseigné à
<code>TRUE</code>, les fonctions réduisent la dimension d’un tableau de
4 ou 5 dimensions en construisant un certain nombre de tableaux liés de
3 dimensions chacun. Ces tableaux contiennent exactement les mêmes
cellules que le tableau original. Puis, la fonction
<code>tab_multi_manager</code> est appelée pour organiser la pose du
secret sur l’ensemble de ces tableaux. `A la fin du processus, on
récupère la table de départ - avec ses dimensions originales - augmentée
des informations sur le secret secondaire.</p>
<p>Ainsi, point important à retenir, la pose du secret secondaire est
toujours réalisée par les algorithmes de <code>Tau-Argus</code>, le
package <code>rtauargus</code> ne fait que découper le tableau en
sous-tableaux à trois dimensions et assurer la cohérence du secret entre
ces différents sous-tableaux liés entre eux.</p>
<p>Cette méthode est susceptible de générer plus de secret qu’une
attaque directe du problème. Mais celle-ci étant impossible dans les cas
visés, c’est un moindre mal.</p>
<p>Pour utiliser cette fonctionnalité, il est nécessaire que
l’utilisateur pose de lui-même le secret primaire en amont.</p>
<div class="section level3">
<h3 id="comment-la-réduction-dun-tableau-à-4-ou-5-dimensions-est-elle-réalisée">Comment la réduction d’un tableau à 4 ou 5 dimensions est-elle
réalisée ?<a class="anchor" aria-label="anchor" href="#comment-la-r%C3%A9duction-dun-tableau-%C3%A0-4-ou-5-dimensions-est-elle-r%C3%A9alis%C3%A9e"></a>
</h3>
<p>Pour passer de 5 à 3 dimensions, on utilise deux fois de suite la
méthode utilisée pour réduire un tableau en sous-tableaux ayant une
dimension de moins.</p>
<p>Le passage de 4 à 3 dimensions consiste d’abord à fusionner deux des
quatre dimensions du tableau original, c’est-à-dire qu’on remplace deux
des variables de départ par une seule dont les modalités sont la fusion
des modalités des deux variables choisies.</p>
<p>Dans l’exemple ci-dessous, on fusionne par exemple les deux variables
<code>SEX</code> et <code>AGE</code> pour n’en faire qu’une seule
appelée <code>SEX_AGE</code>.</p>
<div style="text-align: center;">
<p><img src="tab_SEX_AGE.png" alt="base_tab" width="600" height="500"></p>
</div>
<p>Mais, la nouvelle variable contient des modalités non-emboîtées entre
elles, comme, par exemple, les modalités <code>Femme_Total</code> et
<code>Ensemble_Adulte</code>.</p>
<div style="text-align: center; font-size: 20px;">
<pre><code><span><span class="va">Total_Ensemble</span> <span class="op">=</span> <span class="va">Total_Adulte</span> <span class="op">+</span> <span class="va">Total_Enfant</span></span></code></pre>
</div>
<div style="text-align: center; font-size: 20px;">
<pre><code><span><span class="va">Total_Ensemble</span> <span class="op">=</span> <span class="va">Femme_Ensemble</span> <span class="op">+</span> <span class="va">Homme_Ensemble</span></span></code></pre>
</div>
<p>Or, nous savons gérer la présence de hiérarchies non-emboîtées dans
un tableau. Il suffit, en effet, de construire les sous-tableaux de même
structure de telle sorte que dans chacun de ces sous-tableaux la
variable incriminée soit restreinte à une partie parfaitement emboîtée
de ses modalités. Pour poser le secret sur les sous-tableaux liés
engendrés, il est fait appel à la fonction
<code>tab_multi_manager</code>, spécialement conçue pour assurer la
cohérence du secret entre tableaux liés.</p>
<p>Ici, la fusion nécessite la construction de deux sous-tableaux,
chacun ayant une variable <code>SEX__AGE</code> parfaitement
hiérarchique. Le premier rassemble les modalités
<code>Total_Ensemble</code>, <code>Total_Adulte</code> et
<code>Total_Enfant</code>, le second <code>Total_Ensemble</code>,
<code>Femme_Ensemble</code> et <code>Homme_Ensemble</code>.</p>
<p>Cet exemple est le plus simple qu’il soit: en fusionnant deux
variables non hiérarchiques, on est amené à générer deux
sous-tableaux.</p>
<p>Lorsque l’une des variables fusionnées est elle-même hiérarchique, la
construction des sous-tableaux s’appuie sur les différents sous-totaux
présents dans la hiérarchie, comme indiqué dans la figure
ci-dessous:</p>
<div style="text-align: center;">
<p><img src="GEO.png" alt="hierarchie" width="375" height="150"></p>
</div>
</div>
<div class="section level3">
<h3 id="pour-aller-plus-loin">Pour aller plus loin<a class="anchor" aria-label="anchor" href="#pour-aller-plus-loin"></a>
</h3>
<ul>
<li><a href="https://github.com/InseeFrLab/dims_reduction_tables_workshop_20231215" class="external-link">Article
présentant la méthode et des résultats de simulation</a></li>
</ul>
</div>
<div class="section level3">
<h3 id="les-principaux-arguments-ajoutés-à-tab_rtauargus-et-tab_multi_manager">Les principaux arguments ajoutés à <code>tab_rtauargus()</code> et
<code>tab_multi_manager()</code><a class="anchor" aria-label="anchor" href="#les-principaux-arguments-ajout%C3%A9s-%C3%A0-tab_rtauargus-et-tab_multi_manager"></a>
</h3>
<p>Pour activer le découpage des tableaux de dimension 4 ou 5 en
sous-tableaux de 3 dimensions, l’utilisateur doit activer l’argument
<code>split_tab</code> en le passant à <code>TRUE</code>. Cette valeur
est sa valeur par défaut. Ainsi, l’utilisateur veillera à passer cet
argument à <code>FALSE</code> s’il souhaite qu’un tableau à 4 dimensions
soit traité directement par <code>Tau-Argus</code>.</p>
<p>L’argument <code>nb_tab_option</code> permet de préciser la façon
dont le tableau est découpé:</p>
<ul>
<li>L’option <code>"min"</code> consiste à construire le minimum de
tables à 3 dimensions lors de la fusion. Ce sont donc des variables non
hiérarchiques qui seront fusionnées en priorité.</li>
<li>L’option <code>"max"</code> au contraire construit le maximum de
tables à 3 dimensions possible lors de la fusion. Ce sont donc des
variables hiérarchiques qui seront fusionnées en priorité. Cette option
est intéressante pour réduire la taille des sous-tableaux produits et
donc augmenter les chances que <code>Tau-Argus</code> puisse les
traiter. L’inconvénient de cette option est qu’elle peut générer un très
grand nombre de tableaux, nombre dépendant du nombre de noeuds dans les
hiérarchies.</li>
<li>L’option <code>"smart"</code> va chercher à construire le minimum de
tables à 3 dimensions tout en cherchant à respecter une limite de taille
(nombre de lignes) pour les sous-tableaux construits. Cette limite est
fixée par l’argument <code>limit</code>. Par défaut, la valeur est fixée
à <code>14 700</code> - choisie de par notre expérience. Si la limite
n’est pas atteignable, un avertissement est affiché mais cela ne bloque
pas la construction des tables et la pose du masque.</li>
</ul>
<p>Par défaut, l’argument <code>nb_tab_option</code> est fixé à
<code>"smart"</code>. Il est déconseillé de changer cette valeur dans un
premier temps.</p>
<ul>
<li>L’argument <code>nb_tab = "min"</code> est intéressant en termes de
secret car c’est l’option qui génèrera le moins de sur-secret
puisqu’elle construira le moins possible de sous-tableaux liés. Il peut
être intéressant à utiliser si la table de départ contient un nombre de
lignes raisonnables, c’est-à-dire si chaque dimension n’est pas trop
ventilée.</li>
<li>L’argument <code>nb_tab = "max"</code> créant le plus de tableaux
possibles engendrera nécessairement le plus de secret, mais elle pourra
aussi convenir quand les tableaux d’origine sont très longs et
nécessitent d’être beaucoup découpés pour que la pose du secret soit
possible avec <code>Tau-Argus</code>.</li>
</ul>
</div>
<div class="section level3">
<h3 id="exemple">Exemple<a class="anchor" aria-label="anchor" href="#exemple"></a>
</h3>
<p>Comme tout est géré par la fonction <code>tab_rtauargus</code>, la
pose du secret sur un tableau à 4 ou 5 dimensions n’ajoute pas de
difficultés particulières pour l’utilisateur en réalité.</p>
<p>Nous présentons ici un exemple de pose de secret sur un tableau à 4
dimensions.</p>
<div class="section level4">
<h4 id="préparation-des-données">Préparation des données<a class="anchor" aria-label="anchor" href="#pr%C3%A9paration-des-donn%C3%A9es"></a>
</h4>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jabiru/tictoc" class="external-link">tictoc</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://inseefrlab.github.io/rtauargus">rtauargus</a></span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span></span>
<span>  rtauargus.tauargus_exe <span class="op">=</span></span>
<span>    <span class="st">"Y:/Logiciels/TauArgus/TauArgus4.2.3/TauArgus.exe"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"datatest1"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">datatest1</span><span class="op">)</span></span>
<span><span class="co">#&gt; tibble [689 x 12] (S3: tbl_df/tbl/data.frame)</span></span>
<span><span class="co">#&gt;  $ treff         : chr [1:689] "tr1" "tr2" "tr3" "Total" ...</span></span>
<span><span class="co">#&gt;  $ cj            : chr [1:689] "Total" "Total" "Total" "PA" ...</span></span>
<span><span class="co">#&gt;  $ type_distrib  : chr [1:689] "Total" "Total" "Total" "Total" ...</span></span>
<span><span class="co">#&gt;  $ A10           : chr [1:689] "Total" "Total" "Total" "Total" ...</span></span>
<span><span class="co">#&gt;  $ nb_obs        : num [1:689] 227093 7803 227 1443 125904 ...</span></span>
<span><span class="co">#&gt;  $ pizzas_tot    : num [1:689] 5900938 6538420 6794859 15128 10168928 ...</span></span>
<span><span class="co">#&gt;  $ pizzas_max    : num [1:689] 135444 267177 852749 2756 523505 ...</span></span>
<span><span class="co">#&gt;  $ is_secret_freq: logi [1:689] FALSE FALSE FALSE FALSE FALSE FALSE ...</span></span>
<span><span class="co">#&gt;  $ is_secret_dom : logi [1:689] FALSE FALSE FALSE FALSE FALSE FALSE ...</span></span>
<span><span class="co">#&gt;  $ is_secret_prim: logi [1:689] FALSE FALSE FALSE FALSE FALSE FALSE ...</span></span>
<span><span class="co">#&gt;  $ nb_obs_rnd    : num [1:689] 227094 7804 228 1444 125905 ...</span></span>
<span><span class="co">#&gt;  $ pizzas_tot_abs: num [1:689] 5900938 6538420 6794859 15128 10168928 ...</span></span>
<span><span class="co">#&gt;  - attr(*, ".internal.selfref")=&lt;externalptr&gt;</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="préparation-des-arguments-pour-tab_rtauargus">Préparation des arguments pour <code>tab_rtauargus</code><a class="anchor" aria-label="anchor" href="#pr%C3%A9paration-des-arguments-pour-tab_rtauargus"></a>
</h4>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">totcode</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>treff <span class="op">=</span><span class="st">"Total"</span>,cj <span class="op">=</span><span class="st">"Total"</span>, A10 <span class="op">=</span> <span class="st">"Total"</span>, type_distrib <span class="op">=</span><span class="st">"Total"</span><span class="op">)</span></span>
<span><span class="va">explanatory_vars</span><span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">totcode</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="pose-du-secret-primaire">Pose du secret primaire<a class="anchor" aria-label="anchor" href="#pose-du-secret-primaire"></a>
</h4>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">datatest1_with_prim</span> <span class="op">&lt;-</span> <span class="va">datatest1</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>      is_secret_freq <span class="op">=</span> <span class="op">(</span><span class="va">nb_obs</span> <span class="op">&gt;</span> <span class="fl">0</span> <span class="op">&amp;</span> <span class="va">nb_obs</span> <span class="op">&lt;</span> <span class="fl">3</span><span class="op">)</span>,</span>
<span>      is_secret_dom <span class="op">=</span> <span class="op">(</span><span class="va">pizzas_tot</span> <span class="op">!=</span> <span class="fl">0</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">(</span><span class="va">pizzas_max</span> <span class="op">&gt;</span> <span class="fl">0.85</span><span class="op">*</span><span class="va">pizzas_tot</span><span class="op">)</span>,</span>
<span>      pizzas_tot<span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">pizzas_tot</span><span class="op">)</span>,<span class="fl">2</span><span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>      is_secret_prim <span class="op">=</span>  <span class="va">is_secret_freq</span> ,</span>
<span>      nb_obs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">ceiling</a></span><span class="op">(</span><span class="va">nb_obs</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="pose-du-secret-secondaire-avec-rtauargus">Pose du secret secondaire avec <code>rtauargus</code><a class="anchor" aria-label="anchor" href="#pose-du-secret-secondaire-avec-rtauargus"></a>
</h4>
<p>Pour poser le secret secondaire, on utilise la fonction
<code>tab_rtauargus</code> avec l’argument
<code>split_tab = TRUE</code>. Ainsi, <code>Tau-Argus</code> n’aura pas
à traiter directement le secret sur la table à 4 dimensions. La fonction
<code>tab_rtauargus</code> va découper la table originale en un certain
nombre de tables qui seront protégées comme des tables liées avec un
appel sous-jacent à <code>tab_multi_manager</code>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">tictoc</span><span class="fu">::</span><span class="fu">tic</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">res_wi_split</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tab_rtauargus.html">tab_rtauargus</a></span><span class="op">(</span></span>
<span>    tabular <span class="op">=</span> <span class="va">datatest1_with_prim</span>,</span>
<span>    files_name <span class="op">=</span> <span class="st">"datatest1"</span>,</span>
<span>    dir_name <span class="op">=</span> <span class="st">"example_1"</span>,</span>
<span>    explanatory_vars <span class="op">=</span> <span class="va">explanatory_vars</span>,</span>
<span>    totcode <span class="op">=</span> <span class="va">totcode</span>,</span>
<span>    value <span class="op">=</span> <span class="st">"pizzas_tot"</span>,</span>
<span>    freq <span class="op">=</span> <span class="st">"nb_obs"</span>,</span>
<span>    secret_var <span class="op">=</span> <span class="st">"is_secret_prim"</span>,</span>
<span>    verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    split_tab <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Reducing dims...</span></span>
<span><span class="co">#&gt;  tab </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Choosing variables...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Reducing from 4 to 3...</span></span>
<span><span class="co">#&gt; tab has generated 2 tables in total</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Spliting...</span></span>
<span><span class="co">#&gt;  treff___cj </span></span>
<span><span class="co">#&gt; tab has generated 2 tables in total</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; --- Current table to treat:  tab1 ---</span></span>
<span><span class="co">#&gt; --- Current table to treat:  tab2 ---</span></span>
<span><span class="co">#&gt; --- Current table to treat:  tab1 ---</span></span>
<span><span class="co">#&gt; --- Current table to treat:  tab2 ---</span></span>
<span><span class="co">#&gt; --- Current table to treat:  tab1 ---</span></span>
<span><span class="fu">tictoc</span><span class="fu">::</span><span class="fu">toc</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; 45.31 sec elapsed</span></span></code></pre></div>
<p>La réduction de dimensions a conduit à construire deux sous-tableaux
de 3 dimensions à partir du tableau original.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">res_wi_split</span><span class="op">)</span></span>
<span><span class="co">#&gt; 'data.frame':    689 obs. of  17 variables:</span></span>
<span><span class="co">#&gt;  $ treff         : chr  "Total" "tr1" "tr1" "tr1" ...</span></span>
<span><span class="co">#&gt;  $ cj            : chr  "Total" "LL" "SP" "Total" ...</span></span>
<span><span class="co">#&gt;  $ type_distrib  : chr  "1" "1" "1" "1" ...</span></span>
<span><span class="co">#&gt;  $ A10           : chr  "AZ" "AZ" "AZ" "AZ" ...</span></span>
<span><span class="co">#&gt;  $ nb_obs        : num  115 89 21 110 6 ...</span></span>
<span><span class="co">#&gt;  $ pizzas_tot    : num  8447 769 1301 532 7915 ...</span></span>
<span><span class="co">#&gt;  $ pizzas_max    : num  1471.2 13.8 96.4 96.4 1471.2 ...</span></span>
<span><span class="co">#&gt;  $ is_secret_freq: logi  FALSE FALSE FALSE FALSE FALSE FALSE ...</span></span>
<span><span class="co">#&gt;  $ is_secret_dom : logi  FALSE TRUE FALSE FALSE FALSE FALSE ...</span></span>
<span><span class="co">#&gt;  $ is_secret_prim: logi  FALSE FALSE FALSE FALSE FALSE FALSE ...</span></span>
<span><span class="co">#&gt;  $ nb_obs_rnd    : num  115 89 21 110 6 ...</span></span>
<span><span class="co">#&gt;  $ pizzas_tot_abs: num  8447 769 1301 532 7915 ...</span></span>
<span><span class="co">#&gt;  $ is_secret_1   : logi  FALSE TRUE FALSE TRUE TRUE TRUE ...</span></span>
<span><span class="co">#&gt;  $ is_secret_2   : logi  FALSE TRUE TRUE TRUE TRUE TRUE ...</span></span>
<span><span class="co">#&gt;  $ is_secret_3   : logi  FALSE TRUE TRUE TRUE TRUE TRUE ...</span></span>
<span><span class="co">#&gt;  $ is_secret_4   : logi  FALSE TRUE TRUE TRUE TRUE TRUE ...</span></span>
<span><span class="co">#&gt;  $ is_secret_5   : logi  FALSE TRUE TRUE TRUE TRUE TRUE ...</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">stats_wi_split</span> <span class="op">&lt;-</span> <span class="va">res_wi_split</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/rename.html" class="external-link">rename_with</a></span><span class="op">(</span> <span class="op">~</span><span class="st">"final_suppress"</span>, <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html" class="external-link">last_col</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>      flag <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>        <span class="va">is_secret_freq</span> <span class="op">~</span> <span class="st">"A"</span>,</span>
<span>        <span class="va">is_secret_dom</span> <span class="op">~</span> <span class="st">"B"</span>,</span>
<span>        <span class="va">final_suppress</span> <span class="op">~</span> <span class="st">"D"</span>,</span>
<span>        <span class="cn">TRUE</span> <span class="op">~</span><span class="st">"V"</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">flag</span><span class="op">)</span></span>
<span><span class="va">stats_wi_split</span></span>
<span><span class="co">#&gt;   flag   n</span></span>
<span><span class="co">#&gt; 1    A  79</span></span>
<span><span class="co">#&gt; 2    B  35</span></span>
<span><span class="co">#&gt; 3    D 278</span></span>
<span><span class="co">#&gt; 4    V 297</span></span></code></pre></div>
<p>Avec l’option de découpage du tableau de départ, la pose du secret
sur le tableau à 4 dimensions génère 278 suppressions secondaires.</p>
</div>
<div class="section level4">
<h4 id="comparaison-avec-une-pose-du-secret-sans-réduire-la-dimension-de-la-table">Comparaison avec une pose du secret sans réduire la dimension de la
table<a class="anchor" aria-label="anchor" href="#comparaison-avec-une-pose-du-secret-sans-r%C3%A9duire-la-dimension-de-la-table"></a>
</h4>
<p><code>Tau-Argus</code> est en capacité de poser le secret secondaire
sur un tableau à 4 dimensions avec <code>Modular</code>, mais, en plus
d’émettre un avertissement sur le fait qu’avec ce nombre de dimensions,
la qualité du résultat n’est pas garantie, il est aussi beaucoup plus
long à poser le secret secondaire que lorsqu’il traite deux tables liées
issues du tableau original.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">tictoc</span><span class="fu">::</span><span class="fu">tic</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">res_wo_split</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tab_rtauargus.html">tab_rtauargus</a></span><span class="op">(</span></span>
<span>    tabular <span class="op">=</span> <span class="va">datatest1_with_prim</span>,</span>
<span>    files_name <span class="op">=</span> <span class="st">"datatest1"</span>,</span>
<span>    dir_name <span class="op">=</span> <span class="st">"example_1/wo_split"</span>,</span>
<span>    explanatory_vars <span class="op">=</span> <span class="va">explanatory_vars</span>,</span>
<span>    totcode <span class="op">=</span> <span class="va">totcode</span>,</span>
<span>    value <span class="op">=</span> <span class="st">"pizzas_tot"</span>,</span>
<span>    freq <span class="op">=</span> <span class="st">"nb_obs"</span>,</span>
<span>    secret_var <span class="op">=</span> <span class="st">"is_secret_prim"</span>,</span>
<span>    verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    split_tab <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning :</span></span>
<span><span class="co">#&gt; It is highly recommended to use split_tab = TRUE when using rtauargus with 4 or 5 dimensions tables.</span></span>
<span><span class="co">#&gt; It allows to split the table in several tables with 3 dimensions.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; With split_tab = FALSE, tauargus treats the table in 4 or 5 dimensions.</span></span>
<span><span class="co">#&gt; In this case, the secondary secret may not being optimal according to tauargus itself</span></span>
<span><span class="co">#&gt; and the process may take longer.</span></span>
<span><span class="co">#&gt; Start of batch procedure; file: Z:\SDC\OutilsConfidentialite\rtauargus\vignettes\example_1\wo_split\datatest1.arb</span></span>
<span><span class="co">#&gt; &lt;OPENTABLEDATA&gt; "Z:\SDC\OutilsConfidentialite\rtauargus\vignettes\example_1\wo_split\datatest1.tab"</span></span>
<span><span class="co">#&gt; &lt;OPENMETADATA&gt; "Z:\SDC\OutilsConfidentialite\rtauargus\vignettes\example_1\wo_split\datatest1.rda"</span></span>
<span><span class="co">#&gt; &lt;SPECIFYTABLE&gt; "treff""cj""A10""type_distrib"|"pizzas_tot"||</span></span>
<span><span class="co">#&gt; &lt;SAFETYRULE&gt; MAN(10)</span></span>
<span><span class="co">#&gt; &lt;READTABLE&gt; 1</span></span>
<span><span class="co">#&gt; Tables have been read</span></span>
<span><span class="co">#&gt; &lt;APRIORI&gt; "Z:\SDC\OutilsConfidentialite\rtauargus\vignettes\example_1\wo_split\datatest1.hst",1,",",0,0</span></span>
<span><span class="co">#&gt; Apriory file: Z:\SDC\OutilsConfidentialite\rtauargus\vignettes\example_1\wo_split\datatest1.hst has been applied</span></span>
<span><span class="co">#&gt;                    to table: treff x cj x A10 x type_distrib | pizzas_tot</span></span>
<span><span class="co">#&gt; Apriori file Z:\SDC\OutilsConfidentialite\rtauargus\vignettes\example_1\wo_split\datatest1.hst has been read</span></span>
<span><span class="co">#&gt; &lt;SUPPRESS&gt; MOD(1,5,1,0,0)</span></span>
<span><span class="co">#&gt; Start of the modular protection for table treff x cj x A10 x type_distrib | pizzas_tot</span></span>
<span><span class="co">#&gt; WARNING: The table has 4 dimensions.</span></span>
<span><span class="co">#&gt;                    Running Modular can take a lot of time and maybe it is difficult to obtain a correct result.</span></span>
<span><span class="co">#&gt;                    Please check the results carefully.</span></span>
<span><span class="co">#&gt;                    </span></span>
<span><span class="co">#&gt; End of modular protection. Time used 301 seconds</span></span>
<span><span class="co">#&gt;                    Number of suppressions: 291</span></span>
<span><span class="co">#&gt; &lt;WRITETABLE&gt; (1,4,,"Z:\SDC\OutilsConfidentialite\rtauargus\vignettes\example_1\wo_split\datatest1.csv")</span></span>
<span><span class="co">#&gt; Table: treff x cj x A10 x type_distrib | pizzas_tot has been written</span></span>
<span><span class="co">#&gt;                    Output file name: Z:\SDC\OutilsConfidentialite\rtauargus\vignettes\example_1\wo_split\datatest1.csv</span></span>
<span><span class="co">#&gt; End of TauArgus run</span></span>
<span><span class="fu">tictoc</span><span class="fu">::</span><span class="fu">toc</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; 306.34 sec elapsed</span></span></code></pre></div>
<p>Avec seulement 689 lignes et aucune variable hiérarchique, la pose
directe du secret prend environ 5 minutes à <code>Tau-Argus</code>.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">stats_wo_split</span> <span class="op">&lt;-</span> <span class="va">res_wo_split</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>      flag <span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>        <span class="va">is_secret_freq</span> <span class="op">~</span> <span class="st">"A"</span>,</span>
<span>        <span class="va">is_secret_dom</span> <span class="op">~</span> <span class="st">"B"</span>,</span>
<span>        <span class="cn">TRUE</span> <span class="op">~</span> <span class="va">Status</span></span>
<span>      <span class="op">)</span></span>
<span>    <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">flag</span><span class="op">)</span></span>
<span><span class="va">stats_wo_split</span></span>
<span><span class="co">#&gt;   flag   n</span></span>
<span><span class="co">#&gt; 1    A  79</span></span>
<span><span class="co">#&gt; 2    B  35</span></span>
<span><span class="co">#&gt; 3    D 265</span></span>
<span><span class="co">#&gt; 4    V 310</span></span></code></pre></div>
<p>La pose directe du secret sur le tableau à 4 dimensions génère 265
suppressions secondaires.</p>
<p>On peut observer que le traitement de la table à 4 dimensions
directement génère un masque un peu moins chargé en secret: 266 cellules
en secret secondaire, contre 278 avec une réduction de dimensions.</p>
<p>Il est difficile d’anticiper cette différence puisqu’elle est très
dépendante de la structuration des données, de la présence du secret
primaire au sein du tableau original et de la façon dont les
sous-tableaux vont être construits.</p>
</div>
</div>
<div class="section level2">
<h2 id="détail-de-la-vignette">Détail de la vignette<a class="anchor" aria-label="anchor" href="#d%C3%A9tail-de-la-vignette"></a>
</h2>
<ul>
<li><p>Authors: <strong><a> Wistan Pomel </a></strong> &amp; <strong><a>
Andre-Raymond Socard </a></strong> &amp;
<strong><a href="mailto:julien.jamme@insee.fr">Julien Jamme</a></strong>
&amp; <strong><a>Nathanael Rastout</a></strong></p></li>
<li><p>Last update: <strong>11/01/2024</strong></p></li>
<li><p>Version of rtauargus used: <strong>1.2.0</strong></p></li>
<li><p>Version of τ-Argus used : <strong>TauArgus
4.2.3</strong></p></li>
<li>
<p>R version used : <strong>4.2.3</strong></p>
<p style="text-align: right">
</p>
<p><a href="#TOC" title="Back to summary">summary ↑</a></p>
</li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Pierre-Yves Berrard, Julien Jamme, Nathanaël Rastout, Jeanne Pointet, Félix Beroud, André-Raymond Socard, Wistan Pomel, Clara Baudry.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
