<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="rtauargus">
<title>τ-Argus from R - tabular version • rtauargus</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="τ-Argus from R - tabular version">
<meta property="og:description" content="rtauargus">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">rtauargus</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item">
  <a class="nav-link" href="../articles/rtauargus.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/options_safety_rules.html">Safety rules and Suppress Options</a>
    <a class="dropdown-item" href="../articles/protect_multi_tables.html">Protect several linked tables at once</a>
    <a class="dropdown-item" href="../articles/rtauargus_micro.html">&amp;tau;-Argus from R</a>
    <a class="dropdown-item" href="../articles/rtauargus_micro_fr.html">&amp;tau;-Argus depuis R</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="rtauargus_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>τ-Argus from R - tabular version</h1>
            <h3 data-toc-skip class="subtitle"><h2>
<img src="R_logo_small.png" alt="logo R"><img src="TauBall2_small.png" alt="logo τ-Argus"><br>Package {rtauargus}
</h2></h3>
            
      
      <small class="dont-index">Source: <a href="https://github.com/inseefrlab/rtauargus/blob/HEAD/vignettes/rtauargus.Rmd" class="external-link"><code>vignettes/rtauargus.Rmd</code></a></small>
      <div class="d-none name"><code>rtauargus.Rmd</code></div>
    </div>

    
    
<!--
  NE JAMAIS MODIFIER DIRECTEMENT `rtauargus.Rmd`
  MODIFIER `rtauargus.Rmd.orig` ET EXECUTER `precompilation.R`
  Voir : https://ropensci.org/technotes/2019/12/08/precompute-vignettes
-->
<!-- ####################################################################### -->
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<div class="section level3">
<h3 id="presentation-of-the-package">Presentation of the package<a class="anchor" aria-label="anchor" href="#presentation-of-the-package"></a>
</h3>
<p>The <em>rtauargus</em> package offers an <strong>R</strong> interface for <strong>τ-Argus</strong>. It allows to :</p>
<ul>
<li>create inputs (asc, tab and rda files) from R data;</li>
<li>generate the sequence of instructions to be executed in batch mode (arb file);</li>
<li>launch a batch τ-Argus ;</li>
<li>retrieve the results in R.</li>
</ul>
<p>The syntax of some of the arguments closely matches the <em>batch</em> syntax of τ-Argus. This allows a large number of functions to be used without multiplying the arguments of the functions. The package will also be able to adapt more easily to possible modifications of the software (new methods available, additional options…). The syntax rules for writing batch are given in the τ-Argus reference manual and will be specified in a dedicated help section.</p>
<blockquote>
<p>The package was developed on the basis of open source versions of τ-Argus (versions 4.2 and above), in particular the latest version available at the time of development (4.2.2b1).</p>
<p>It is not compatible with version 3.5.**_</p>
</blockquote>
</div>
<div class="section level3">
<h3 id="purpose-of-this-document">Purpose of this document<a class="anchor" aria-label="anchor" href="#purpose-of-this-document"></a>
</h3>
<p>This document aims to explain the main functionalities of the package, using relatively simple examples. A detailed documentation of any function (exhaustive list of arguments, technical aspects…) is available <em>via</em> the dedicated help section.</p>
<p style="text-align: right">
<a href="#TOC" title="Return to summary">summary ↑</a>
</p>
<!-- ####################################################################### -->
</div>
</div>
<div class="section level2">
<h2 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h2>
<p>The following setup should be made before the first use (and no longer afterwards)</p>
<div class="section level3">
<h3 id="τ-argus">τ-Argus<a class="anchor" aria-label="anchor" href="#%CF%84-argus"></a>
</h3>
<p><em>rtauargus</em> fonctions using τ-Argus requires that the software can be used from the workstation. The github repository of τ-Argus is here: <a href="https://github.com/sdcTools/tauargus" class="external-link">https://github.com/sdcTools/tauargus</a>. The latest releases can be downloaded here: <a href="https://github.com/sdcTools/tauargus/releases" class="external-link">https://github.com/sdcTools/tauargus/releases</a>.</p>
</div>
<div class="section level3">
<h3 id="dependencies">Dependencies<a class="anchor" aria-label="anchor" href="#dependencies"></a>
</h3>
<p><em>rtauargus</em> requires some other R packages.Those are the dependencies to install.</p>
<pre><code>• purrr (&gt;= 0.2),
• dplyr (&gt;= 0.7),
• gdata,
• stringr,
• rlang,
• zoo</code></pre>
<p>The package <em>rtauargus</em> can be installed now.</p>
<p style="text-align: right">
<a href="#TOC" title="Return to summary">sommaire ↑</a>
</p>
<!-- ####################################################################### -->
</div>
</div>
<div class="section level2">
<h2 id="quick-start">Quick Start<a class="anchor" aria-label="anchor" href="#quick-start"></a>
</h2>
<p>This section explains how to perform a minimal configuration of the package and how to apply suppressive methods in a single instruction.</p>
<div class="section level3">
<h3 id="location-of-τ-argus">Location of τ-Argus<a class="anchor" aria-label="anchor" href="#location-of-%CF%84-argus"></a>
</h3>
<p>When loading the package, the console displays some information:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://inseefrlab.github.io/rtauargus">rtauargus</a></span><span class="op">)</span></span></code></pre></div>
<p>In particular, a plausible location for the τ-Argus software is predefined. This can be changed for the duration of the R session, as follows:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">loc_tauargus</span> <span class="op">&lt;-</span> <span class="st">"Y:/Logiciels/TauArgus/TauArgus4.2.2b1/TauArgus.exe"</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>rtauargus.tauargus_exe <span class="op">=</span> <span class="va">loc_tauargus</span><span class="op">)</span></span></code></pre></div>
<p>With this small adjustment done, the package is ready to be used.</p>
<blockquote>
<p><em>For a more customized configuration, see the specific vignettes</em></p>
</blockquote>
</div>
<div class="section level3">
<h3 id="protecting-a-single-tabular-data-with-tab_rtauargus-function">Protecting a single tabular data with <code>tab_rtauargus()</code> function<a class="anchor" aria-label="anchor" href="#protecting-a-single-tabular-data-with-tab_rtauargus-function"></a>
</h3>
<p>The <code><a href="../reference/tab_rtauargus.html">tab_rtauargus()</a></code> function performs a full processing to protect the table and retrieves the results immediately in R.</p>
<p>Completely abstracting from the inner workings of τ-Argus, it allows the entire processing to be made in a single instruction. All intermediate files are created in a local directory.</p>
<p><code><a href="../reference/tab_rtauargus.html">tab_rtauargus()</a></code> requires the following arguments :</p>
<ul>
<li>
<code>tabular</code>: a data.frame containing the table ;</li>
<li>
<code>dir_name</code>: the directory for the outputs;</li>
<li>
<code>files_name</code>: all the τ-Argus files will be named with it (different extensions);</li>
<li>
<code>explanatory_vars</code>: the name of all explanatory variables in <code>tabular</code>;</li>
<li>
<code>secret_var</code> or <code>safety_rules</code>: the way to apply primary suppression (explain later)</li>
<li>
<code>totcode</code>: the code for total of each explanatory variable in <code>tabular</code>
</li>
</ul>
<p>All the arguments and their default options will be detailed ( where?).</p>
<div class="section level4">
<h4 id="minimal-example">Minimal example<a class="anchor" aria-label="anchor" href="#minimal-example"></a>
</h4>
<p>For the following demonstration, a fictitious table will be used:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">act_size</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    ACTIVITY <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"01"</span>,<span class="st">"01"</span>,<span class="st">"01"</span>,<span class="st">"02"</span>,<span class="st">"02"</span>,<span class="st">"02"</span>,<span class="st">"06"</span>,<span class="st">"06"</span>,<span class="st">"06"</span>,<span class="st">"Total"</span>,<span class="st">"Total"</span>,<span class="st">"Total"</span><span class="op">)</span>,</span>
<span>    SIZE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"tr1"</span>,<span class="st">"tr2"</span>,<span class="st">"Total"</span>,<span class="st">"tr1"</span>,<span class="st">"tr2"</span>,<span class="st">"Total"</span>,<span class="st">"tr1"</span>,<span class="st">"tr2"</span>,<span class="st">"Total"</span>,<span class="st">"tr1"</span>,<span class="st">"tr2"</span>,<span class="st">"Total"</span><span class="op">)</span>,</span>
<span>    VAL <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>,<span class="fl">50</span>,<span class="fl">150</span>,<span class="fl">30</span>,<span class="fl">20</span>,<span class="fl">50</span>,<span class="fl">60</span>,<span class="fl">40</span>,<span class="fl">100</span>,<span class="fl">190</span>,<span class="fl">110</span>,<span class="fl">300</span><span class="op">)</span>,</span>
<span>    N_OBS <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>,<span class="fl">5</span>,<span class="fl">15</span>,<span class="fl">2</span>,<span class="fl">5</span>,<span class="fl">7</span>,<span class="fl">8</span>,<span class="fl">6</span>,<span class="fl">14</span>,<span class="fl">20</span>,<span class="fl">16</span>,<span class="fl">36</span><span class="op">)</span>,</span>
<span>    MAX <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">20</span>,<span class="fl">15</span>,<span class="fl">20</span>,<span class="fl">20</span>,<span class="fl">10</span>,<span class="fl">20</span>,<span class="fl">16</span>,<span class="fl">38</span>,<span class="fl">38</span>,<span class="fl">20</span>,<span class="fl">38</span>,<span class="fl">38</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="va">act_size</span></span>
<span><span class="co">#&gt;    ACTIVITY  SIZE VAL N_OBS MAX</span></span>
<span><span class="co">#&gt; 1        01   tr1 100    10  20</span></span>
<span><span class="co">#&gt; 2        01   tr2  50     5  15</span></span>
<span><span class="co">#&gt; 3        01 Total 150    15  20</span></span>
<span><span class="co">#&gt; 4        02   tr1  30     2  20</span></span>
<span><span class="co">#&gt; 5        02   tr2  20     5  10</span></span>
<span><span class="co">#&gt; 6        02 Total  50     7  20</span></span>
<span><span class="co">#&gt; 7        06   tr1  60     8  16</span></span>
<span><span class="co">#&gt; 8        06   tr2  40     6  38</span></span>
<span><span class="co">#&gt; 9        06 Total 100    14  38</span></span>
<span><span class="co">#&gt; 10    Total   tr1 190    20  20</span></span>
<span><span class="co">#&gt; 11    Total   tr2 110    16  38</span></span>
<span><span class="co">#&gt; 12    Total Total 300    36  38</span></span></code></pre></div>
<p>As primary rules, we use the two following ones:</p>
<ul>
<li>The n-k dominance rule with n=1 and k = 85</li>
<li>The minimum frequency rule with n = 3 and a safety range of 10.</li>
</ul>
<p>To get the results for the dominance rule, we need to specify the largest contributor to each cell, corresponding to the <code>MAX</code> variable in the tabular data.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ex1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tab_rtauargus.html">tab_rtauargus</a></span><span class="op">(</span></span>
<span>  <span class="va">act_size</span>,</span>
<span>  dir_name <span class="op">=</span> <span class="st">"tauargus_files/ex1"</span>,</span>
<span>  files_name <span class="op">=</span> <span class="st">"ex1"</span>,</span>
<span>  explanatory_vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ACTIVITY"</span>,<span class="st">"SIZE"</span><span class="op">)</span>,</span>
<span>  safety_rules <span class="op">=</span> <span class="st">"FREQ(3,10)|NK(1,85)"</span>,</span>
<span>  value <span class="op">=</span> <span class="st">"VAL"</span>,</span>
<span>  freq <span class="op">=</span> <span class="st">"N_OBS"</span>,</span>
<span>  maxscore <span class="op">=</span> <span class="st">"MAX"</span>,</span>
<span>  totcode <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>ACTIVITY<span class="op">=</span><span class="st">"Total"</span>,SIZE<span class="op">=</span><span class="st">"Total"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Start of batch procedure; file: Z:\SDC\OutilsConfidentialite\rtauargus\vignettes\tauargus_files\ex1\ex1.arb</span></span>
<span><span class="co">#&gt; &lt;OPENTABLEDATA&gt; "Z:\SDC\OutilsConfidentialite\rtauargus\vignettes\tauargus_files\ex1\ex1.tab"</span></span>
<span><span class="co">#&gt; &lt;OPENMETADATA&gt; "Z:\SDC\OutilsConfidentialite\rtauargus\vignettes\tauargus_files\ex1\ex1.rda"</span></span>
<span><span class="co">#&gt; &lt;SPECIFYTABLE&gt; "ACTIVITY""SIZE"|"VAL"||</span></span>
<span><span class="co">#&gt; &lt;SAFETYRULE&gt; FREQ(3,10)|NK(1,85)</span></span>
<span><span class="co">#&gt; &lt;READTABLE&gt; 1</span></span>
<span><span class="co">#&gt; Tables have been read</span></span>
<span><span class="co">#&gt; &lt;SUPPRESS&gt; MOD(1,5,1,0,0)</span></span>
<span><span class="co">#&gt; Start of the modular protection for table ACTIVITY x SIZE | VAL</span></span>
<span><span class="co">#&gt; End of modular protection. Time used 0 seconds</span></span>
<span><span class="co">#&gt;                    Number of suppressions: 2</span></span>
<span><span class="co">#&gt; &lt;WRITETABLE&gt; (1,4,,"Z:\SDC\OutilsConfidentialite\rtauargus\vignettes\tauargus_files\ex1\ex1.csv")</span></span>
<span><span class="co">#&gt; Table: ACTIVITY x SIZE | VAL has been written</span></span>
<span><span class="co">#&gt;                    Output file name: Z:\SDC\OutilsConfidentialite\rtauargus\vignettes\tauargus_files\ex1\ex1.csv</span></span>
<span><span class="co">#&gt; End of TauArgus run</span></span></code></pre></div>
<p>By default, the function displays in the console the logbook content in which user can read all steps run by τ-Argus. This can be retrieved in the logbook.txt file. With <code>verbose = FALSE</code>, the function can be silenced.</p>
<p>By default, the function returns the original dataset with one variable more, called <code>Status</code>, directly resulting from τ-Argus and describing the status of each cell as follows:</p>
<p>-<code>A</code>: primary secret cell because of frequency rule; -<code>B</code>: primary secret cell because of dominance rule (1st contributor); -<code>C</code>: primary secret cell because of frequency rule (more contributors in case when n&gt;1); -<code>D</code>: secondary secret cell; -<code>V</code>: valid cells - no need to mask.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ex1</span></span>
<span><span class="co">#&gt;    ACTIVITY  SIZE VAL N_OBS MAX Status</span></span>
<span><span class="co">#&gt; 1        01 Total 150    15  20      V</span></span>
<span><span class="co">#&gt; 2        01   tr1 100    10  20      V</span></span>
<span><span class="co">#&gt; 3        01   tr2  50     5  15      V</span></span>
<span><span class="co">#&gt; 4        02 Total  50     7  20      V</span></span>
<span><span class="co">#&gt; 5        02   tr1  30     2  20      A</span></span>
<span><span class="co">#&gt; 6        02   tr2  20     5  10      D</span></span>
<span><span class="co">#&gt; 7        06 Total 100    14  38      V</span></span>
<span><span class="co">#&gt; 8        06   tr1  60     8  16      D</span></span>
<span><span class="co">#&gt; 9        06   tr2  40     6  38      B</span></span>
<span><span class="co">#&gt; 10    Total Total 300    36  38      V</span></span>
<span><span class="co">#&gt; 11    Total   tr1 190    20  20      V</span></span>
<span><span class="co">#&gt; 12    Total   tr2 110    16  38      V</span></span></code></pre></div>
<p>All the files generated by the function are written in the specified directory (<code>dir_name</code> argument). The default format for the protected table is csv but it can be changed. All the τ-Argus files (.tab, .rda, .arb and .txt) are written in the same directory, too. To go further, you can consult the latest version of the τ-Argus manual is downloadable here: <a href="https://research.cbs.nl/casc/Software/TauManualV4.1.pdf" class="external-link">https://research.cbs.nl/casc/Software/TauManualV4.1.pdf</a>.</p>
</div>
<div class="section level4">
<h4 id="example-with-hierarchy-and-primary-secret-already-done">Example with hierarchy and primary secret already done<a class="anchor" aria-label="anchor" href="#example-with-hierarchy-and-primary-secret-already-done"></a>
</h4>
<div class="section level5">
<h5 id="data">Data<a class="anchor" aria-label="anchor" href="#data"></a>
</h5>
<p>For this example, we’d like to protect a table in which companies’ turnover is broken down by business sectors and size. To load the data, do:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"turnover_act_size"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">turnover_act_size</span><span class="op">)</span></span>
<span><span class="co">#&gt; # A tibble: 6 x 5</span></span>
<span><span class="co">#&gt;   ACTIVITY SIZE  N_OBS       TOT       MAX</span></span>
<span><span class="co">#&gt;   &lt;chr&gt;    &lt;chr&gt; &lt;int&gt;     &lt;dbl&gt;     &lt;dbl&gt;</span></span>
<span><span class="co">#&gt; 1 AZ       Total   405    44475.     6212.</span></span>
<span><span class="co">#&gt; 2 BE       Total 12878 24827613.  1442029.</span></span>
<span><span class="co">#&gt; 3 FZ       Total 28043  8907311.  1065833.</span></span>
<span><span class="co">#&gt; 4 GI       Total 62053 26962063.  3084242.</span></span>
<span><span class="co">#&gt; 5 JZ       Total  8135  8584917.  3957364.</span></span>
<span><span class="co">#&gt; 6 KZ       Total  8140 62556596. 10018017.</span></span></code></pre></div>
<p>The meaning of each variable is:</p>
<p>-<code>ACTIVITY</code>: business sector, hierarchical variables with three levels described in the <code>activity_corr_table</code> dataset. The root is noted “Total”; -<code>SIZE</code>: size of the companies (Number of employees in three categories + overall category “Total”); -<code>N_OBS</code>: Frequency, number of companies; -<code>TOT</code>: turnover value in euros; -<code>MAX</code>: turnover of the company which contributes the most to the cell.</p>
</div>
<div class="section level5">
<h5 id="hierarchys-file">Hierarchy’s file<a class="anchor" aria-label="anchor" href="#hierarchys-file"></a>
</h5>
<p>Before performing the <code><a href="../reference/tab_rtauargus.html">tab_rtauargus()</a></code> function, we have to prepare the hierarchical information into the appropriate format for τ-Argus, <em>.i.e.</em> a <code>.hrc</code> file. From a correspondence table, the <code><a href="../reference/write_hrc2.html">write_hrc2()</a></code> function does the job for you.</p>
<p>Here, the correspondence table describes the nesting of the three levels of business sectors, from the most aggregated to the least one:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">activity_corr_table</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">activity_corr_table</span><span class="op">)</span></span>
<span><span class="co">#&gt;   A10 A21 A88</span></span>
<span><span class="co">#&gt; 1  AZ   A  01</span></span>
<span><span class="co">#&gt; 2  AZ   A  02</span></span>
<span><span class="co">#&gt; 3  AZ   X   X</span></span>
<span><span class="co">#&gt; 4  BE   B  06</span></span>
<span><span class="co">#&gt; 5  BE   B  07</span></span>
<span><span class="co">#&gt; 6  BE   B  08</span></span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hrc_file_activity</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/write_hrc2.html">write_hrc2</a></span><span class="op">(</span></span>
<span>  corr_table <span class="op">=</span> <span class="va">activity_corr_table</span>,</span>
<span>  file_name <span class="op">=</span> <span class="st">"hrc/activity.hrc"</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="primary-secret">Primary secret<a class="anchor" aria-label="anchor" href="#primary-secret"></a>
</h5>
<p>In this example, we’ll apply the primary secret ourselves, <em>i.e.</em> not with the help of τ-Argus. The idea is to use τ-Argus with an apriori file. For that purpose, we create a boolean variable to specify which cells don’t comply with the primary secret rules. Using the same rules as before, we get:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">turnover_act_size</span> <span class="op">&lt;-</span> <span class="va">turnover_act_size</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    is_secret_freq <span class="op">=</span> <span class="va">N_OBS</span> <span class="op">&gt;</span> <span class="fl">0</span> <span class="op">&amp;</span> <span class="va">N_OBS</span> <span class="op">&lt;</span> <span class="fl">3</span>,</span>
<span>    is_secret_dom <span class="op">=</span> <span class="va">MAX</span> <span class="op">&gt;</span> <span class="va">TOT</span><span class="op">*</span><span class="fl">0.85</span>,</span>
<span>    is_secret_prim <span class="op">=</span> <span class="va">is_secret_freq</span> <span class="op">|</span> <span class="va">is_secret_dom</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="running-τ-argus">Running τ-Argus<a class="anchor" aria-label="anchor" href="#running-%CF%84-argus"></a>
</h5>
<p>Two arguments has to be added to the <code><a href="../reference/tab_rtauargus.html">tab_rtauargus()</a></code> function:</p>
<p>-<code>secret_var</code>, indicating the name of the variable in <code>tabular</code> containing the primary secret (apriori) information; -<code>hrc</code>, indicating the name of the hierarchy file to use for <code>ACTIVITY</code> variable.</p>
<p>Since the primary suppression was already specified, no need to use the arguments, <code>safety_rules</code> and <code>maxscore</code>. The first one is set by default to “MAN(10)”, so as to say that a 10% Interval Protection is applied.</p>
<p>By default, <code><a href="../reference/tab_rtauargus.html">tab_rtauargus()</a></code> runs the Modular method to perform the secondary secret. Here, we choose to use the Optimal method by changing the <code>suppress</code> argument.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ex2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tab_rtauargus.html">tab_rtauargus</a></span><span class="op">(</span></span>
<span>  <span class="va">turnover_act_size</span>,</span>
<span>  dir_name <span class="op">=</span> <span class="st">"tauargus_files/ex2"</span>,</span>
<span>  files_name <span class="op">=</span> <span class="st">"ex2"</span>,</span>
<span>  explanatory_vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ACTIVITY"</span>,<span class="st">"SIZE"</span><span class="op">)</span>,</span>
<span>  value <span class="op">=</span> <span class="st">"TOT"</span>,</span>
<span>  freq <span class="op">=</span> <span class="st">"N_OBS"</span>,</span>
<span>  secret_var <span class="op">=</span> <span class="st">"is_secret_prim"</span>,</span>
<span>  hrc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>ACTIVITY <span class="op">=</span> <span class="va">hrc_file_activity</span><span class="op">)</span>,</span>
<span>  totcode <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>ACTIVITY<span class="op">=</span><span class="st">"Total"</span>,SIZE<span class="op">=</span><span class="st">"Total"</span><span class="op">)</span>,</span>
<span>  suppress <span class="op">=</span> <span class="st">"OPT(1,5)"</span>,</span>
<span>  verbose<span class="op">=</span><span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="result">Result<a class="anchor" aria-label="anchor" href="#result"></a>
</h5>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">ex2</span><span class="op">)</span></span>
<span><span class="co">#&gt; 'data.frame':    414 obs. of  9 variables:</span></span>
<span><span class="co">#&gt;  $ ACTIVITY      : chr  "01" "01" "02" "02" ...</span></span>
<span><span class="co">#&gt;  $ SIZE          : chr  "Total" "tr1" "Total" "tr1" ...</span></span>
<span><span class="co">#&gt;  $ N_OBS         : int  18 18 387 381 6 1 1 4 4 84 ...</span></span>
<span><span class="co">#&gt;  $ TOT           : num  853 853 43623 35503 8120 ...</span></span>
<span><span class="co">#&gt;  $ MAX           : num  303 303 6212 6212 4812 ...</span></span>
<span><span class="co">#&gt;  $ is_secret_freq: logi  FALSE FALSE FALSE FALSE FALSE TRUE ...</span></span>
<span><span class="co">#&gt;  $ is_secret_dom : logi  FALSE FALSE FALSE FALSE FALSE TRUE ...</span></span>
<span><span class="co">#&gt;  $ is_secret_prim: logi  FALSE FALSE FALSE FALSE FALSE TRUE ...</span></span>
<span><span class="co">#&gt;  $ Status        : chr  "V" "V" "V" "V" ...</span></span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">ex2</span><span class="op">$</span><span class="va">Status</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   B   D   V </span></span>
<span><span class="co">#&gt;  77  64 273</span></span></code></pre></div>
<p>As we can see in the <code><a href="https://rdrr.io/r/base/table.html" class="external-link">table()</a></code> results, all the primary secret has the status “B” in the output produced by τ-Argus. To adjust this, we can do:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ex2</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>    Status <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html" class="external-link">case_when</a></span><span class="op">(</span></span>
<span>      <span class="va">is_secret_freq</span> <span class="op">~</span> <span class="st">"A"</span>,</span>
<span>      <span class="cn">TRUE</span> <span class="op">~</span> <span class="va">Status</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/count.html" class="external-link">count</a></span><span class="op">(</span><span class="va">Status</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Status   n</span></span>
<span><span class="co">#&gt; 1      A  52</span></span>
<span><span class="co">#&gt; 2      B  25</span></span>
<span><span class="co">#&gt; 3      D  64</span></span>
<span><span class="co">#&gt; 4      V 273</span></span></code></pre></div>
</div>
</div>
</div>
<div class="section level3">
<h3 id="protecting-several-tables-at-the-same-time-with-tab_muli_manager-function">Protecting several tables at the same time, with <code>tab_muli_manager()</code> function<a class="anchor" aria-label="anchor" href="#protecting-several-tables-at-the-same-time-with-tab_muli_manager-function"></a>
</h3>
<p>The function <code><a href="../reference/tab_multi_manager.html">tab_multi_manager()</a></code> can deal with a whole set of (linked or not) tables. It is an iterating process, performing secondary suppression with one table at a time and it ensures that the common cells have the same status. When a common cell is concerned by secondary suppression, it reverberates the secret on each table that shares this common cell. The process ends when the secondary secret is consistent in every tables. See more details in vignettes <em>Manage the protection of linked tables</em></p>
<div class="section level4">
<h4 id="data-1">Data<a class="anchor" aria-label="anchor" href="#data-1"></a>
</h4>
<p>For this example, two tables will be used :</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"turnover_act_size"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"turnover_act_cj"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">turnover_act_cj</span><span class="op">)</span></span>
<span><span class="co">#&gt; tibble [406 x 5] (S3: tbl_df/tbl/data.frame)</span></span>
<span><span class="co">#&gt;  $ ACTIVITY: chr [1:406] "AZ" "BE" "FZ" "GI" ...</span></span>
<span><span class="co">#&gt;  $ CJ      : chr [1:406] "Total" "Total" "Total" "Total" ...</span></span>
<span><span class="co">#&gt;  $ N_OBS   : int [1:406] 405 12878 28043 62053 8135 8140 11961 41359 26686 25108 ...</span></span>
<span><span class="co">#&gt;  $ TOT     : num [1:406] 44475 24827613 8907311 26962063 8584917 ...</span></span>
<span><span class="co">#&gt;  $ MAX     : num [1:406] 6212 1442029 1065833 3084242 3957364 ...</span></span></code></pre></div>
<p>The second tabular dataset provides the turnover of companies broken down by business sectors (<code>ACTIVITY</code>) and type of company (<code>CJ</code>). The latter has three categories and the overall category is noted “Total”.</p>
<p>Since the two tables share one common explanatory variable (<code>ACTIVITY</code>), they can’t be treated separately without risk of inconsistent protection.</p>
</div>
<div class="section level4">
<h4 id="primary-secret-1">Primary secret<a class="anchor" aria-label="anchor" href="#primary-secret-1"></a>
</h4>
<p>The first step consists in indicating whether each cell complies with the primary rules, or not. A boolean variable is created, equal to TRUE if the cell doesn’t comply.</p>
<p>Here, we use the same rules as previously.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">list_data_2_tabs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  act_size <span class="op">=</span> <span class="va">turnover_act_size</span>,</span>
<span>  act_cj <span class="op">=</span> <span class="va">turnover_act_cj</span></span>
<span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>  <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html" class="external-link">map</a></span><span class="op">(</span></span>
<span>    <span class="kw">function</span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">{</span></span>
<span>      <span class="va">df</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>        <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span></span>
<span>          is_secret_freq <span class="op">=</span> <span class="va">N_OBS</span> <span class="op">&gt;</span> <span class="fl">0</span> <span class="op">&amp;</span> <span class="va">N_OBS</span> <span class="op">&lt;</span> <span class="fl">3</span>,</span>
<span>          is_secret_dom <span class="op">=</span> <span class="va">MAX</span> <span class="op">&gt;</span> <span class="va">TOT</span><span class="op">*</span><span class="fl">0.85</span>,</span>
<span>          is_secret_prim <span class="op">=</span> <span class="va">is_secret_freq</span> <span class="op">|</span> <span class="va">is_secret_dom</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="running-τ-argus-1">Running τ-Argus<a class="anchor" aria-label="anchor" href="#running-%CF%84-argus-1"></a>
</h4>
<p>Now that the primary secret has been specified for both tables, we can run the process.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ex3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/tab_multi_manager.html">tab_multi_manager</a></span><span class="op">(</span></span>
<span>  list_tables <span class="op">=</span> <span class="va">list_data_2_tabs</span>,</span>
<span>  list_explanatory_vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    act_size <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ACTIVITY"</span>, <span class="st">"SIZE"</span><span class="op">)</span>,</span>
<span>    act_cj <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ACTIVITY"</span>, <span class="st">"CJ"</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  hrc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>ACTIVITY <span class="op">=</span> <span class="va">hrc_file_activity</span><span class="op">)</span>,</span>
<span>  dir_name <span class="op">=</span> <span class="st">"tauargus_files/ex3"</span>,</span>
<span>  value <span class="op">=</span> <span class="st">"TOT"</span>,</span>
<span>  freq <span class="op">=</span> <span class="st">"N_OBS"</span>,</span>
<span>  secret_var <span class="op">=</span> <span class="st">"is_secret_prim"</span>,</span>
<span>  totcode <span class="op">=</span>  <span class="st">"Total"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; --- Current table to treat:  act_size ---</span></span>
<span><span class="co">#&gt; --- Current table to treat:  act_cj ---</span></span>
<span><span class="co">#&gt; --- Current table to treat:  act_size ---</span></span></code></pre></div>
<p>By default, the function uses a wrapper of <code><a href="../reference/tab_rtauargus.html">tab_rtauargus()</a></code> function, called <code><a href="../reference/tab_rtauargus2.html">tab_rtauargus2()</a></code>, to apply secondary secret with τ-Argus. Many default parameters are set. In particular:</p>
<ul>
<li>Interval Protection fixed to 10;</li>
<li>Suppress method set to "MOD(1,5,1,0,0);</li>
<li>Output.</li>
</ul>
<p>When running, the function displays at each iteration which table is treated.</p>
<p>The vignette <em>Manage the protection of linked tables</em> provides a full presentation of <code><a href="../reference/tab_multi_manager.html">tab_multi_manager()</a></code> function.</p>
</div>
<div class="section level4">
<h4 id="about-this-vignette">About this vignette<a class="anchor" aria-label="anchor" href="#about-this-vignette"></a>
</h4>
<ul>
<li>Authors: <strong><a href="mailto:julien.jamme@insee.fr">Julien Jamme</a></strong> &amp; <strong><a href="mailto:nathanael.rastout@insee.fr">Nathanael Rastout</a></strong>
</li>
<li>Last update: <strong>02/10/2022</strong>
</li>
<li>Version of rtauargus used: <strong>1.1.0</strong>
</li>
<li>Version of τ-Argus used : <strong>TauArgus 4.2.2b1</strong>
</li>
<li>R version used : <strong>4.1.3</strong>
</li>
</ul>
<p style="text-align: right">
<a href="#TOC" title="Back to summary">summary ↑</a>
</p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Pierre-Yves Berrard, Julien Jamme, Nathanaël Rastout, Jeanne Pointet, Félix Beroud.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
